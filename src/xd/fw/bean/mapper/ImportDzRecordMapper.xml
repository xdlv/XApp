<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="xd.fw.bean.mapper.ImportDzRecordMapper" >
  <resultMap id="ImportDzRecordResultMap" type="xd.fw.bean.ImportDzRecord" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="year" property="year" jdbcType="SMALLINT" />
    <result column="month" property="month" jdbcType="SMALLINT" />
    <result column="notification" property="notification" jdbcType="CHAR" />
    <result column="import_date" property="importDate" jdbcType="DATE" />
  </resultMap>
  <insert id="insert" parameterType="xd.fw.bean.ImportDzRecord" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_import_dz_record (year, month, notification, 
      import_date)
    values (#{year,jdbcType=SMALLINT}, #{month,jdbcType=SMALLINT}, #{notification,jdbcType=CHAR}, 
      #{importDate,jdbcType=DATE})
  </insert>

  <select id="getAllImportDzRecords" resultMap="ImportDzRecordResultMap">
    select * from t_import_dz_record order by import_date desc
  </select>

    <select id="getImportDzRecordByYearAndMonth" parameterType="java.lang.Integer" resultMap="ImportDzRecordResultMap">
        select * from t_import_dz_record where year = #{year,jdbcType=INTEGER}
        and month=#{month,jdbcType=INTEGER}
    </select>

    <update id="updateImportDzRecordStatus" parameterType="xd.fw.bean.ImportDzRecord" >
        update t_import_dz_record
        set notification = #{notification,jdbcType=VARCHAR}
        where year = #{year,jdbcType=INTEGER} and month=#{month,jdbcType=INTEGER}
    </update>

    <select id="selectDzRecordByStatus" parameterType="java.lang.String" resultMap="ImportDzRecordResultMap">
        select * from t_import_dz_record where notification=#{notification,jdbcType=VARCHAR}
    </select>

  <select id="getLastedNotifyImportDzRecord" parameterType="java.lang.String" resultMap="ImportDzRecordResultMap">
    select * from t_import_dz_record where notification= 'E' order by year + month desc
  </select>

  <delete id="deleteImportDzRecordByYearAndMonth" parameterType="java.lang.Integer">
     delete from t_import_dz_record where year = #{year,jdbcType=INTEGER}
        and month=#{month,jdbcType=INTEGER}
  </delete>

</mapper>